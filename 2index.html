<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Neon Life: Particle Sandbox</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;800&display=swap');

        body {
            margin: 0;
            background-color: #050505;
            color: #fff;
            overflow: hidden;
            font-family: 'JetBrains Mono', monospace;
            touch-action: none;
        }

        canvas {
            display: block;
            width: 100vw;
            height: 100vh;
        }

        /* --- UI --- */
        #ui-layer {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
        }

        .panel {
            position: absolute;
            background: rgba(10, 10, 15, 0.9);
            border: 1px solid #444;
            backdrop-filter: blur(10px);
            padding: 15px;
            border-radius: 8px;
            pointer-events: auto;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 0 20px rgba(0,0,0,0.8);
            width: 300px;
        }

        #settings { top: 10px; left: 10px; }
        #presets { bottom: 10px; left: 10px; width: auto; display: flex; gap: 10px; flex-wrap: wrap;}

        h2 {
            margin: 0 0 10px 0; color: #fff; font-size: 14px; text-transform: uppercase;
            border-bottom: 1px solid #333; padding-bottom: 5px; letter-spacing: 1px;
        }

        /* –ú–∞—Ç—Ä–∏—Ü–∞ –ø—Ä–∞–≤–∏–ª */
        .matrix-grid {
            display: grid;
            grid-template-columns: 20px repeat(4, 1fr);
            gap: 2px;
            margin-bottom: 15px;
        }
        .matrix-header {
            font-size: 10px; text-align: center; color: #888; padding: 2px;
        }
        .matrix-row-label {
            font-size: 10px; color: #888; display: flex; align-items: center; justify-content: center;
        }
        .matrix-cell input {
            width: 100%; height: 25px;
            background: #111; border: 1px solid #333;
            color: #fff; text-align: center; font-size: 11px;
            font-family: inherit;
        }
        .matrix-cell input:focus { border-color: #fff; outline: none; background: #222; }

        /* –°–ª–∞–π–¥–µ—Ä—ã */
        .control-group { margin-bottom: 10px; }
        label { font-size: 11px; color: #aaa; display: flex; justify-content: space-between; margin-bottom: 3px; }
        .val { color: #0f0; font-weight: bold; }
        input[type=range] {
            width: 100%; height: 4px; background: #333;
            accent-color: #0f0; cursor: pointer; appearance: none; border-radius: 2px;
        }

        /* –ö–Ω–æ–ø–∫–∏ */
        .btn {
            background: #222; color: #fff; border: 1px solid #444;
            padding: 8px 12px; font-family: inherit; font-size: 11px;
            cursor: pointer; text-transform: uppercase; border-radius: 4px;
            transition: 0.2s;
        }
        .btn:hover { background: #fff; color: #000; box-shadow: 0 0 10px #fff; }
        .btn-green { border-color: #0f0; color: #0f0; }
        .btn-green:hover { background: #0f0; color: #000; box-shadow: 0 0 10px #0f0; }
        .btn-rand { width: 100%; margin-top: 5px; background: linear-gradient(90deg, #333, #444); }

        /* –¶–≤–µ—Ç–∞ —Ä–∞—Å */
        .c-red { color: #ff0055; }
        .c-green { color: #00ff55; }
        .c-blue { color: #0055ff; }
        .c-yellow { color: #ffcc00; }

        #fps-meter {
            position: absolute; top: 10px; right: 10px;
            color: #444; font-size: 10px; pointer-events: none;
        }

        .hint { font-size: 9px; color: #666; margin-top: 5px; line-height: 1.4; }
    </style>
</head>
<body>

    <div id="ui-layer">
        <div id="fps-meter">FPS: 60</div>

        <div class="panel" id="settings">
            <h2>–ü–ê–†–ê–ú–ï–¢–†–´ –°–†–ï–î–´</h2>

            <div class="control-group">
                <label>–ö–æ–ª-–≤–æ —á–∞—Å—Ç–∏—Ü: <span id="v-count" class="val">1200</span></label>
                <input type="range" min="200" max="3000" step="100" value="1200" oninput="UI.updCount(this.value)">
            </div>

            <div class="control-group">
                <label>–†–∞–¥–∏—É—Å –∑—Ä–µ–Ω–∏—è: <span id="v-radius" class="val">80</span></label>
                <input type="range" min="10" max="200" value="80" oninput="Sim.radius = Number(this.value); UI.updText('radius', this.value)">
            </div>

            <div class="control-group">
                <label>–¢—Ä–µ–Ω–∏–µ (0-1): <span id="v-friction" class="val">0.5</span></label>
                <input type="range" min="0.01" max="0.99" step="0.01" value="0.5" oninput="Sim.friction = Number(this.value); UI.updText('friction', this.value)">
            </div>

            <div class="control-group">
                <label>–°–∏–ª–∞ –æ—Ç—Ç–∞–ª–∫–∏–≤–∞–Ω–∏—è (–±–ª–∏–∂–Ω—è—è): <span id="v-repel" class="val">1.0</span></label>
                <input type="range" min="0.1" max="5.0" step="0.1" value="1.0" oninput="Sim.beta = Number(this.value); UI.updText('repel', this.value)">
            </div>

            <h2>–ú–ê–¢–†–ò–¶–ê –í–õ–ò–Ø–ù–ò–Ø</h2>
            <div class="hint">–ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ —á–∏—Å–ª–∞ = –ü—Ä–∏—Ç—è–∂–µ–Ω–∏–µ<br>–û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ = –û—Ç—Ç–∞–ª–∫–∏–≤–∞–Ω–∏–µ</div>
            <br>
            <div class="matrix-grid" id="matrix-container">
                <!-- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è JS -->
            </div>

            <button class="btn btn-rand" onclick="Sim.randomizeRules()">üé≤ –°–õ–£–ß–ê–ô–ù–´–ï –ü–†–ê–í–ò–õ–ê</button>
        </div>

        <div class="panel" id="presets">
            <button class="btn btn-green" onclick="Presets.load('snake')">üêç –ó–ú–ï–ò</button>
            <button class="btn btn-green" onclick="Presets.load('cell')">ü¶† –ö–õ–ï–¢–ö–ò</button>
            <button class="btn btn-green" onclick="Presets.load('galaxy')">üåå –ì–ê–õ–ê–ö–¢–ò–ö–ò</button>
            <button class="btn btn-green" onclick="Presets.load('chaos')">üí• –•–ê–û–°</button>
        </div>
    </div>

    <canvas id="canvas"></canvas>

<script>
    // --- –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ---
    const COLORS = ['#ff0055', '#00ff55', '#0055ff', '#ffcc00']; // R, G, B, Y
    const TYPES = 4;

    // --- –°–ò–ú–£–õ–Ø–¢–û–† ---
    const Sim = {
        canvas: document.getElementById('canvas'),
        ctx: document.getElementById('canvas').getContext('2d', { alpha: false }), // –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è
        w: 0, h: 0,

        particles: [],
        count: 1200,

        // –§–∏–∑–∏–∫–∞
        radius: 80,    // –†–∞–¥–∏—É—Å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è
        friction: 0.5, // –ß–µ–º –º–µ–Ω—å—à–µ, —Ç–µ–º –±–æ–ª—å—à–µ –∏–Ω–µ—Ä—Ü–∏—è (0.9 = –ª–µ–¥, 0.1 = –∫–∏—Å–µ–ª—å)
        beta: 1.0,     // –°–∏–ª–∞ –æ—Ç—Ç–∞–ª–∫–∏–≤–∞–Ω–∏—è –ø—Ä–∏ –æ—á–µ–Ω—å –±–ª–∏–∑–∫–æ–º –∫–æ–Ω—Ç–∞–∫—Ç–µ (—á—Ç–æ–±—ã –Ω–µ —Å–ª–∏–ø–∞–ª–∏—Å—å –≤ —Ç–æ—á–∫—É)

        // –ú–∞—Ç—Ä–∏—Ü–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π (4x4)
        // –ü—Ä–∞–≤–∏–ª–æ: rules[A][B] = —Å–∏–ª–∞, —Å –∫–æ—Ç–æ—Ä–æ–π A —Ç—è–Ω–µ—Ç—Å—è –∫ B
        rules: [],

        init() {
            this.resize();
            window.addEventListener('resize', () => this.resize());

            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—É—Å—Ç–æ–π –º–∞—Ç—Ä–∏—Ü—ã
            for(let i=0; i<TYPES; i++) {
                this.rules[i] = [];
                for(let j=0; j<TYPES; j++) {
                    this.rules[i][j] = 0;
                }
            }

            this.createParticles();
            UI.buildMatrix();
            Presets.load('snake'); // –°—Ç–∞—Ä—Ç —Å –ø—Ä–µ—Å–µ—Ç–∞

            this.loop = this.loop.bind(this);
            requestAnimationFrame(this.loop);
        },

        resize() {
            this.w = window.innerWidth;
            this.h = window.innerHeight;
            this.canvas.width = this.w;
            this.canvas.height = this.h;
        },

        createParticles() {
            this.particles = [];
            for(let i=0; i<this.count; i++) {
                this.particles.push({
                    x: Math.random() * this.w,
                    y: Math.random() * this.h,
                    vx: 0,
                    vy: 0,
                    type: Math.floor(Math.random() * TYPES) // 0..3
                });
            }
        },

        randomizeRules() {
            for(let i=0; i<TYPES; i++) {
                for(let j=0; j<TYPES; j++) {
                    // –°–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ –æ—Ç -1.0 –¥–æ 1.0
                    let val = (Math.random() * 2 - 1).toFixed(2);
                    this.rules[i][j] = Number(val);
                }
            }
            UI.syncMatrixInputs();
        },

        // --- –Ø–î–†–û –§–ò–ó–ò–ö–ò (–°–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ) ---
        update() {
            const rMax = this.radius;
            const rMaxSq = rMax * rMax; // –î–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏
            const forceFactor = 0.5; // –ì–ª–æ–±–∞–ª—å–Ω—ã–π –º–Ω–æ–∂–∏—Ç–µ–ª—å —Å–∏–ª—ã

            for (let i = 0; i < this.particles.length; i++) {
                let p1 = this.particles[i];
                let fx = 0;
                let fy = 0;

                for (let j = 0; j < this.particles.length; j++) {
                    if (i === j) continue; // –ù–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å —Å–æ–±–æ–π

                    let p2 = this.particles[j];

                    let dx = p2.x - p1.x;
                    let dy = p2.y - p1.y;

                    // –¢–æ–ø–æ–ª–æ–≥–∏—è —Ç–æ—Ä–∞ (–±–µ—Å—à–æ–≤–Ω—ã–π –º–∏—Ä)
                    if (dx > this.w * 0.5) dx -= this.w;
                    if (dx < -this.w * 0.5) dx += this.w;
                    if (dy > this.h * 0.5) dy -= this.h;
                    if (dy < -this.h * 0.5) dy += this.h;

                    const distSq = dx*dx + dy*dy;

                    // –ï—Å–ª–∏ —á–∞—Å—Ç–∏—Ü–∞ –≤ —Ä–∞–¥–∏—É—Å–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏
                    if (distSq > 0 && distSq < rMaxSq) {
                        const dist = Math.sqrt(distSq);

                        // F - —Å–∏–ª–∞ –ø—Ä–∏—Ç—è–∂–µ–Ω–∏—è –∏–∑ –º–∞—Ç—Ä–∏—Ü—ã
                        const g = this.rules[p1.type][p2.type];

                        // –§–æ—Ä–º—É–ª–∞ —Å–∏–ª—ã:
                        // 1. –ï—Å–ª–∏ –æ—á–µ–Ω—å –±–ª–∏–∑–∫–æ (< rMax/5) -> –û—Ç—Ç–∞–ª–∫–∏–≤–∞–µ–º—Å—è (–∞–Ω—Ç–∏-—Å–ª–∏–ø–∞–Ω–∏–µ)
                        // 2. –ï—Å–ª–∏ –¥–∞–ª—å—à–µ -> –ü—Ä–∏—Ç—è–≥–∏–≤–∞–µ–º—Å—è/–û—Ç—Ç–∞–ª–∫–∏–≤–∞–µ–º—Å—è –ø–æ –ø—Ä–∞–≤–∏–ª—É G

                        let f = 0;
                        const minDist = rMax * 0.2; // 20% –æ—Ç —Ä–∞–¥–∏—É—Å–∞ - "–ª–∏—á–Ω–∞—è –∑–æ–Ω–∞"

                        if (dist < minDist) {
                            // –°–∏–ª—å–Ω–æ–µ –æ—Ç—Ç–∞–ª–∫–∏–≤–∞–Ω–∏–µ –±–ª–∏–∑–∫–æ
                            // f –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–∞ —Ç–æ–º—É, –Ω–∞—Å–∫–æ–ª—å–∫–æ –º—ã –±–ª–∏–∑–∫–æ
                            const ratio = dist / minDist;
                            f = this.beta * (ratio - 1); 
                        } else {
                            // –û–±—ã—á–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ (–ø–ª–∞–≤–Ω—ã–π —Å–ø–∞–¥)
                            // –ü–∏–∫ —Å–∏–ª—ã –≤ —Å–µ—Ä–µ–¥–∏–Ω–µ, 0 –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–µ —Ä–∞–¥–∏—É—Å–∞
                            // –ü—Ä–æ—Å—Ç–∞—è –ª–∏–Ω–µ–π–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è
                            const ratio = (dist - minDist) / (rMax - minDist);
                            // –°–∏–ª–∞ G —É–º–Ω–æ–∂–∞–µ—Ç—Å—è –Ω–∞ –ø–∞—Ä–∞–±–æ–ª—É –∏–ª–∏ –ª–∏–Ω–∏—é.
                            // –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ—Å—Ç—É—é —Ñ–æ—Ä–º—É–ª—É Life: (1 - ratio) * g
                            f = g * (1 - Math.abs(2 * ratio - 1)); 
                            // –ò–ª–∏ –ø—Ä–æ—â–µ:
                            // f = g * (1/dist); 
                        }

                        // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å–∏–ª—É
                        fx += (dx / dist) * f * forceFactor;
                        fy += (dy / dist) * f * forceFactor;
                    }
                }

                // –ü—Ä–∏–º–µ–Ω—è–µ–º —É—Å–∫–æ—Ä–µ–Ω–∏–µ –∫ —Å–∫–æ—Ä–æ—Å—Ç–∏
                p1.vx = (p1.vx + fx) * this.friction;
                p1.vy = (p1.vy + fy) * this.friction;

                // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–∑–∏—Ü–∏—é
                p1.x += p1.vx;
                p1.y += p1.vy;

                // –ì—Ä–∞–Ω–∏—Ü—ã (–¢–æ—Ä)
                if (p1.x < 0) p1.x += this.w;
                if (p1.x > this.w) p1.x -= this.w;
                if (p1.y < 0) p1.y += this.h;
                if (p1.y > this.h) p1.y -= this.h;
            }
        },

        draw() {
            // "Motion Blur" —ç—Ñ—Ñ–µ–∫—Ç:
            // –í–º–µ—Å—Ç–æ –ø–æ–ª–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏, —Ä–∏—Å—É–µ–º –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —á–µ—Ä–Ω—ã–π –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫.
            // –°—Ç–∞—Ä—ã–µ –∫–∞–¥—Ä—ã –æ—Å—Ç–∞—é—Ç—Å—è –∏ –º–µ–¥–ª–µ–Ω–Ω–æ –≥–∞—Å–Ω—É—Ç.
            this.ctx.globalCompositeOperation = 'source-over';
            this.ctx.fillStyle = 'rgba(5, 5, 5, 0.3)'; 
            this.ctx.fillRect(0, 0, this.w, this.h);

            // –†–µ–∂–∏–º –Ω–∞–ª–æ–∂–µ–Ω–∏—è –¥–ª—è "–°–≤–µ—á–µ–Ω–∏—è"
            this.ctx.globalCompositeOperation = 'lighter';

            for(let i=0; i<this.particles.length; i++) {
                let p = this.particles[i];
                let col = COLORS[p.type];

                this.ctx.fillStyle = col;
                this.ctx.beginPath();
                // –ú–∞–ª–µ–Ω—å–∫–∏–π —Ä–∞–∑–º–µ—Ä –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –Ω–æ —Å–≤–µ—á–µ–Ω–∏–µ –¥–µ–ª–∞–µ—Ç –∏—Ö –≤–∏–¥–∏–º—ã–º–∏
                this.ctx.arc(p.x, p.y, 2.0, 0, Math.PI*2); 
                this.ctx.fill();
            }
        },

        // –ó–∞–º–µ—Ä FPS
        lastTime: 0,
        loop(timestamp) {
            const dt = timestamp - this.lastTime;
            if(dt > 0) {
                document.getElementById('fps-meter').innerText = 'FPS: ' + Math.round(1000/dt);
            }
            this.lastTime = timestamp;

            this.update();
            this.draw();
            requestAnimationFrame(this.loop);
        }
    };

    // --- –ò–ù–¢–ï–†–§–ï–ô–° ---
    const UI = {
        buildMatrix() {
            const container = document.getElementById('matrix-container');
            container.innerHTML = '';

            // –ó–∞–≥–æ–ª–æ–≤–∫–∏ (–¢–∏–ø—ã –ø–æ X)
            container.appendChild(this.createEl('div', ''));
            COLORS.forEach((c, i) => {
                let el = this.createEl('div', 'T'+(i+1), 'matrix-header');
                el.style.color = c;
                container.appendChild(el);
            });

            // –°—Ç—Ä–æ–∫–∏
            for(let i=0; i<TYPES; i++) {
                // –õ–µ–π–±–ª —Ä—è–¥–∞ (–¢–∏–ø –ø–æ Y)
                let label = this.createEl('div', 'T'+(i+1), 'matrix-row-label');
                label.style.color = COLORS[i];
                container.appendChild(label);

                for(let j=0; j<TYPES; j++) {
                    let cell = document.createElement('div');
                    cell.className = 'matrix-cell';

                    let input = document.createElement('input');
                    input.type = 'number';
                    input.step = 0.1;
                    input.min = -2; input.max = 2;
                    input.value = Sim.rules[i][j];
                    input.id = `rule-${i}-${j}`;

                    input.onchange = (e) => {
                        Sim.rules[i][j] = Number(e.target.value);
                    };

                    cell.appendChild(input);
                    container.appendChild(cell);
                }
            }
        },

        createEl(tag, txt, cls) {
            let e = document.createElement(tag);
            if(txt) e.innerText = txt;
            if(cls) e.className = cls;
            return e;
        },

        syncMatrixInputs() {
            for(let i=0; i<TYPES; i++) {
                for(let j=0; j<TYPES; j++) {
                    document.getElementById(`rule-${i}-${j}`).value = Sim.rules[i][j];
                }
            }
        },

        updText(id, val) { document.getElementById('v-'+id).innerText = val; },

        updCount(val) {
            this.updText('count', val);
            Sim.count = Number(val);
            Sim.createParticles();
        }
    };

    // --- –ü–†–ï–°–ï–¢–´ (–°–∞–º–æ–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ) ---
    const Presets = {
        setParams(rad, fric, beta) {
            Sim.radius = rad; document.getElementById('v-radius').innerText = rad; document.querySelector('input[oninput*="Sim.radius"]').value = rad;
            Sim.friction = fric; document.getElementById('v-friction').innerText = fric; document.querySelector('input[oninput*="Sim.friction"]').value = fric;
            Sim.beta = beta; document.getElementById('v-repel').innerText = beta; document.querySelector('input[oninput*="Sim.beta"]').value = beta;
        },

        load(name) {
            // –°–±—Ä–æ—Å –º–∞—Ç—Ä–∏—Ü—ã
            for(let i=0; i<TYPES; i++) for(let j=0; j<TYPES; j++) Sim.rules[i][j] = 0;

            if (name === 'snake') {
                // –ö—Ä–∞—Å–Ω—ã–µ -> –ó–µ–ª–µ–Ω—ã–µ -> –°–∏–Ω–∏–µ -> –ñ–µ–ª—Ç—ã–µ -> –ö—Ä–∞—Å–Ω—ã–µ
                // –ê –¥–æ–≥–æ–Ω—è–µ—Ç –ë, –ë —É–±–µ–≥–∞–µ—Ç –æ—Ç –ê (–Ω–æ –º–µ–¥–ª–µ–Ω–Ω–µ–µ)
                this.setParams(80, 0.5, 1.0);

                // –¶–µ–ø–æ—á–∫–∞ –ø–æ–≥–æ–Ω–∏
                Sim.rules[0][0] = 1.0; Sim.rules[0][1] = 1.0; 
                Sim.rules[1][1] = 1.0; Sim.rules[1][2] = 1.0; 
                Sim.rules[2][2] = 1.0; Sim.rules[2][3] = 1.0;
                Sim.rules[3][3] = 1.0; Sim.rules[3][0] = 1.0;

                // –ù–µ–º–Ω–æ–≥–æ —Å—Ç—Ä–∞—Ö–∞ —á—Ç–æ–±—ã –Ω–µ —Å–ª–∏–ø–∞–ª–∏—Å—å –≤ –∫–æ–º
                Sim.rules[0][2] = -0.5;
                Sim.rules[1][3] = -0.5;
            }

            else if (name === 'cell') {
                // –û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ "–∫–ª–µ—Ç–æ–∫". –°–≤–æ–∏ –ø—Ä–∏—Ç—è–≥–∏–≤–∞—é—Ç—Å—è, —á—É–∂–∏–µ —Å–∏–ª—å–Ω–æ –æ—Ç—Ç–∞–ª–∫–∏–≤–∞—é—Ç—Å—è
                this.setParams(60, 0.15, 2.0); // –í—ã—Å–æ–∫–æ–µ —Ç—Ä–µ–Ω–∏–µ (–∫–∏—Å–µ–ª—å)
                for(let i=0; i<TYPES; i++) {
                    for(let j=0; j<TYPES; j++) {
                        if (i === j) Sim.rules[i][j] = 0.8; // –õ—é–±–æ–≤—å –∫ —Å–≤–æ–∏–º
                        else Sim.rules[i][j] = -0.6;        // –ù–µ–Ω–∞–≤–∏—Å—Ç—å –∫ —á—É–∂–∏–º
                    }
                }
            }

            else if (name === 'galaxy') {
                // –í—Å–µ –ø—Ä–∏—Ç—è–≥–∏–≤–∞—é—Ç—Å—è –∫–æ –≤—Å–µ–º, —Å–æ–∑–¥–∞–≤–∞—è –≤—Ä–∞—â–∞—é—â–∏–π—Å—è –≤–∏—Ö—Ä—å (–∏–∑-–∑–∞ –æ—à–∏–±–∫–∏ –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è –∏ —Ç—Ä–µ–Ω–∏—è)
                this.setParams(150, 0.5, 5.0); // –ë–æ–ª—å—à–æ–π —Ä–∞–¥–∏—É—Å
                for(let i=0; i<TYPES; i++) {
                    for(let j=0; j<TYPES; j++) {
                        Sim.rules[i][j] = 0.5;
                    }
                }
                // –ê—Å–∏–º–º–µ—Ç—Ä–∏—è –¥–ª—è –≤—Ä–∞—â–µ–Ω–∏—è
                Sim.rules[0][1] = 1.0;
                Sim.rules[1][0] = 0.2;
            }

            else if (name === 'chaos') {
                this.setParams(100, 0.6, 1.0);
                Sim.randomizeRules();
            }

            UI.syncMatrixInputs();
            Sim.createParticles(); // –†–µ—Å—Ç–∞—Ä—Ç –ø–æ–∑–∏—Ü–∏–π
        }
    };

    Sim.init();
</script>
</body>
</html>
